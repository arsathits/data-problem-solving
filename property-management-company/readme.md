# üè¢ Problem 3: Property Management Company

## üìå Problem Statement

A real estate company manages various properties on behalf of multiple landlords. You are tasked with building an ETL (Extract, Transform, Load) process to generate a report summarizing the **total rental income** generated by each landlord.

The company has provided two datasets:

1. **`prop_properties`** ‚Äì Information about the properties being managed.
2. **`prop_landlords`** ‚Äì Information about the landlords who own those properties.

Your goal is to produce a summary table that includes each landlord's full name, ID, and the total rental income they earn from all their properties.

---

## üìÇ Input Data

### 1. `prop_properties`

| Column Name   | Data Type | Description                                 |
|---------------|-----------|---------------------------------------------|
| property_id   | Integer   | Unique ID of the property                   |
| landlord_id   | Integer   | ID of the landlord who owns the property    |
| property_type | String    | Type of the property (e.g., Apartment)      |
| rent          | Float     | Monthly rent for the property               |
| square_feet   | Integer   | Total square footage of the property        |
| city          | String    | City where the property is located          |

---

### 2. `prop_landlords`

| Column Name | Data Type | Description                         |
|-------------|-----------|-------------------------------------|
| landlord_id | Integer   | Unique ID of the landlord           |
| first_name  | String    | First name of the landlord          |
| last_name   | String    | Last name of the landlord           |
| email       | String    | Email address of the landlord       |
| phone       | String    | Phone number of the landlord        |

---

## üéØ Expected Output

| Column Name         | Data Type | Description                                         |
|---------------------|-----------|-----------------------------------------------------|
| landlord_id         | Integer   | Unique ID of the landlord                           |
| landlord_name       | String    | Full name of the landlord (`first_name + last_name`)|
| total_rental_income | Float     | Total rental income from all properties owned       |

---

## ‚úÖ Requirements

- Remove any duplicate rows from both input datasets before processing.
- Perform an inner join between the properties and landlords on `landlord_id`.
- Construct a new column `landlord_name` by concatenating `first_name` and `last_name`.
- Only include landlords who have at least one property.
- Group by `landlord_id` and `landlord_name` to compute the **sum of rent** across all their properties.
- Sort the final output by `landlord_id` in ascending order.

---

## üß™ Example

### Input: `prop_properties`

| property_id | landlord_id | property_type | rent | square_feet | city    |
|-------------|-------------|----------------|------|--------------|---------|
| 1           | 101         | Apartment      | 1500 | 1000         | Seattle |
| 2           | 101         | Condo          | 1200 | 800          | Seattle |
| 3           | 102         | House          | 2000 | 1500         | Bellevue |
| 4           | 103         | Apartment      | 1800 | 1200         | Redmond |
| 5           | 103         | Condo          | 1000 | 700          | Redmond |

### Input: `prop_landlords`

| landlord_id | first_name | last_name | email                    | phone         |
|-------------|------------|-----------|--------------------------|---------------|
| 101         | John       | Smith     | john.smith@example.com   | 555-123-4567  |
| 102         | Jane       | Doe       | jane.doe@example.com     | 555-234-5678  |
| 103         | Bob        | Johnson   | bob.johnson@example.com  | 555-345-6789  |
| 104         | Mary       | Williams  | mary.williams@example.com| 555-456-7890  |

### Output:

| landlord_id | landlord_name | total_rental_income |
|-------------|----------------|---------------------|
| 101         | John Smith     | 2700.0              |
| 102         | Jane Doe       | 2000.0              |
| 103         | Bob Johnson    | 2800.0              |

---
